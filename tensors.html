<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="favicon.ico" />
    <title>Defining Tensors - TACO Documentation</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Defining Tensors";
        var mkdocs_page_input_path = "tensors.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> TACO Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">C++ API</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="tensors.html">Defining Tensors</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#declaring-tensors">Declaring Tensors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#defining-tensor-formats">Defining Tensor Formats</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#initializing-tensors">Initializing Tensors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#loading-tensors-from-file">Loading Tensors from File</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#writing-tensors-to-file">Writing Tensors to File</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="computations.html">Computing on Tensors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="scheduling.html">Providing a Schedule</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Python API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="pytensors.html">Defining Tensors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="pycomputations.html">Computing on Tensors</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="http://tensor-compiler.org/reference/">Reference Manual</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Example Applications</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="scientific_computing.html">Scientific Computing: SpMV</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="data_analytics.html">Data Analytics: MTTKRP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="machine_learning.html">Machine Learning: SDDMM</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced Usage</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="optimization.html">Strategies for Optimization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="benchmarking.html">Guide to Benchmarking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="controlling_memory.html">Controlling Memory</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">TACO Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>C++ API &raquo;</li>
      <li>Defining Tensors</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="defining-tensors">Defining Tensors</h1>
<h2 id="declaring-tensors">Declaring Tensors</h2>
<p><code>taco::Tensor</code> objects, which correspond to mathematical tensors, form the core
of the TACO C++ API. You can declare a new tensor by specifying its name, a
vector containing the size of each dimension of the tensor, and the <a href="tensors.html#defining-tensor-formats">storage
format</a> that will be used to store the
tensor:</p>
<pre class="highlight"><code class="language-c++">// Declare a new tensor "A" of double-precision floats with dimensions 
// 512 x 64 x 2048, stored as a dense-sparse-sparse tensor
Tensor&lt;double&gt; A("A", {512,64,2048}, Format({Dense,Sparse,Sparse}));</code></pre>
<p>The name of the tensor can be omitted, in which case TACO will assign an
arbitrary name to the tensor:</p>
<pre class="highlight"><code class="language-c++">// Declare another tensor with the same dimensions and storage format as before
Tensor&lt;double&gt; A({512,64,2048}, Format({Dense,Sparse,Sparse}));</code></pre>
<p>Scalars, which are treated as order-0 tensors, can be declared and initialized
with some arbitrary value as demonstrated below:</p>
<pre class="highlight"><code class="language-c++">Tensor&lt;double&gt; alpha(42.0);  // Declare a scalar tensor initialized to 42.0</code></pre>
<h2 id="defining-tensor-formats">Defining Tensor Formats</h2>
<p>Conceptually, you can think of a tensor as a tree with each level (excluding
the root) corresponding to a dimension of the tensor. Each path from the root
to a leaf node represents a tensor coordinate and its corresponding value.
Which dimension each level of the tree corresponds to is determined by the
order in which dimensions of the tensor are stored.</p>
<p>TACO uses a novel scheme that can describe different storage formats for any
tensor by specifying the order in which tensor dimensions are stored and
whether each dimension is sparse or dense. A sparse dimension stores only the
subset of the dimension that contains non-zero values and is conceptually
similar to the index arrays used in the compressed sparse row (CSR) matrix
format, while a dense dimension stores both zeros and non-zeros. As
demonstrated below, this scheme is flexibile enough to express many
commonly-used matrix storage formats.</p>
<p>You can define a new tensor storage format by creating a <code>taco::Format</code> object.
The constructor for <code>taco::Format</code> takes as arguments a vector specifying the
type of each dimension and (optionally) a vector specifying the order in which
dimensions are to be stored, following the above scheme:</p>
<pre class="highlight"><code class="language-c++">Format   dm({Dense,Dense});           // (Row-major) dense matrix
Format  csr({Dense,Sparse});          // Compressed sparse row matrix
Format  csc({Dense,Sparse}, {1,0});   // Compressed sparse column matrix
Format dcsr({Sparse,Sparse}, {1,0});  // Doubly compressed sparse column matrix</code></pre>
<p>Alternatively, you can define a tensor format that contains only sparse or
dense dimensions as follows:</p>
<pre class="highlight"><code class="language-c++">Format csf(Sparse);  // Compressed sparse fiber tensor</code></pre>
<h2 id="initializing-tensors">Initializing Tensors</h2>
<p>You can initialize a <code>taco::Tensor</code> by calling the <code>insert</code> method to add a
non-zero component to the tensor. The <code>insert</code> method takes two arguments, a
vector specifying the coordinate of the non-zero component to be added and the
value to be inserted at that coordinate:</p>
<pre class="highlight"><code class="language-c++">A.insert({128,32,1024}, 42.0);  // A(128,32,1024) = 42.0</code></pre>
<p>The <code>insert</code> method adds the inserted non-zeros to a temporary buffer. Before a
tensor can actually be used in a computation though, you must invoke the <code>pack</code>
method to compress the tensor into the storage format that was specified when
the tensor was first declared:</p>
<pre class="highlight"><code class="language-c++">A.pack();  // Construct dense-sparse-sparse tensor containing inserted non-zeros</code></pre>
<h2 id="loading-tensors-from-file">Loading Tensors from File</h2>
<p>Rather than manually invoking <code>insert</code> and <code>pack</code> to initialize a tensor, you
can load tensors directly from file by calling <code>taco::read</code> as demonstrated
below:</p>
<pre class="highlight"><code class="language-c++">// Load a dense-sparse-sparse tensor from file A.tns
A = read("A.tns", Format({Dense, Sparse, Sparse}));</code></pre>
<p>By default, <code>taco::read</code> returns a packed tensor. You can optionally pass a
Boolean flag as an argument to indicate whether the returned tensor should be
packed or not:</p>
<pre class="highlight"><code class="language-c++">// Load an unpacked tensor from file A.tns
A = read("A.tns", Format({Dense, Sparse, Sparse}), false);</code></pre>
<p>Currently, TACO supports loading from the following matrix and tensor file
formats:</p>
<ul>
<li><a href="http://math.nist.gov/MatrixMarket/formats.html#MMformat">Matrix Market (Coordinate) Format (.mtx)</a></li>
<li><a href="https://www.cise.ufl.edu/research/sparse/matrices/DOC/rb.pdf">Rutherford-Boeing Format (.rb)</a></li>
<li><a href="http://frostt.io/tensors/file-formats.html">FROSTT Format (.tns)</a></li>
</ul>
<h2 id="writing-tensors-to-file">Writing Tensors to File</h2>
<p>You can also write a (packed) tensor directly to file by calling <code>taco::write</code>,
as demonstrated below:</p>
<pre class="highlight"><code class="language-c++">write("A.tns", A);  // Write tensor A to file A.tns</code></pre>
<p><code>taco::write</code> supports the same set of matrix and tensor file formats as
<code>taco::read</code>.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="computations.html" class="btn btn-neutral float-right" title="Computing on Tensors">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
      <span><a href="computations.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
